# Slotted Page

B+Tree の節は複数の連続するブロックをまとめたPageという単位で扱われます。
内部節のPageにはキーとポインタの組み合わせが保持され、葉にはキーとレコード（またはそれへのポインタ）が保持されることになります。

複数の可変長のレコードをブロックに収めるには、それぞれのブロックにおける開始の位置（オフセット）とサイズを管理する必要になります。
それを実現するために、Slotted Pageという手法があります。これはPageをHeader, Pointerの配列, Cellの配列の構成に分けます。Cellの配列にはレコードがPageの右端から左へ追加されたもので、Pointerの配列でそれぞれのレコードへの参照を保持します。Header, Pointerは左端に位置するので、空きスペースはPointerの配列とCellの配列の間になります。6

B+Treeの場合、Page内のレコードはキー順に並ぶ必要がありますが、この仕組みを利用することでPointerを並び替えるだけで、実際のレコードは空きスペースに順次追加するだけで済みます。
内部節はキーと子へのポインタを持つのでCellはポインタになります。その場合、キーとポインタが1対1の関係になりますが、K個のキーとK+1個のポインタを持つので、実装上は最後のK+1個目のポインタに対応するようにK+1個目のキーを用意したり、特別にそのポインタだけを管理したりします。
